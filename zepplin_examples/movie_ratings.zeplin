{"paragraphs":[{"text":"final case class Rating(movie_id: Int, rating: Int)\nval text_file = sc.textFile(\"hdfs:///movie_data/u.data\")\nval rating_list = text_file.map(x => {val fields = x.split(\"\\t\");Rating(fields(1).toInt, fields(2).toInt )})\nval ratings_DF = rating_list.toDF()\nval topMovies = ratings_DF.groupBy(\"movie_id\").count().orderBy(desc(\"count\")).cache()\ntopMovies.show()\n\n","dateUpdated":"2018-05-07T01:57:19+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1525656378412_-2125094829","id":"20180507-012618_287171993","result":{"code":"SUCCESS","type":"TEXT","msg":"warning: there were 1 unchecked warning(s); re-run with -unchecked for details\ndefined class Rating\ntext_file: org.apache.spark.rdd.RDD[String] = hdfs:///movie_data/u.data MapPartitionsRDD[30] at textFile at <console>:29\nrating_list: org.apache.spark.rdd.RDD[Rating] = MapPartitionsRDD[31] at map at <console>:33\nratings_DF: org.apache.spark.sql.DataFrame = [movie_id: int, rating: int]\ntopMovies: org.apache.spark.sql.DataFrame = [movie_id: int, count: bigint]\n+--------+-----+\n|movie_id|count|\n+--------+-----+\n|      50|  584|\n|     258|  509|\n|     100|  508|\n|     181|  507|\n|     294|  485|\n|     286|  481|\n|     288|  478|\n|       1|  452|\n|     300|  431|\n|     121|  429|\n|     174|  420|\n|     127|  413|\n|      56|  394|\n|       7|  392|\n|      98|  390|\n|     237|  384|\n|     117|  378|\n|     172|  368|\n|     222|  365|\n|     313|  350|\n+--------+-----+\nonly showing top 20 rows\n\n"},"dateCreated":"2018-05-07T01:26:18+0000","dateStarted":"2018-05-07T01:57:19+0000","dateFinished":"2018-05-07T01:57:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:417"},{"text":"ratings_DF.registerTempTable(\"Ratings\")","dateUpdated":"2018-05-07T02:03:29+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1525656833478_1288119933","id":"20180507-013353_736835715","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"2018-05-07T01:33:53+0000","dateStarted":"2018-05-07T02:03:29+0000","dateFinished":"2018-05-07T02:03:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:418"},{"text":"%sql\nselect * from Ratings limit 10","dateUpdated":"2018-05-07T02:05:57+0000","config":{"colWidth":12,"graph":{"mode":"stackedAreaChart","height":300,"optionOpen":false,"keys":[{"name":"movie_id","index":0,"aggr":"sum"}],"values":[{"name":"rating","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"movie_id","index":0,"aggr":"sum"},"yAxis":{"name":"rating","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1525658601552_453511436","id":"20180507-020321_1927917365","result":{"code":"SUCCESS","type":"TABLE","msg":"movie_id\trating\n50\t5\n172\t5\n133\t1\n242\t3\n302\t3\n377\t1\n51\t2\n346\t1\n474\t4\n265\t2\n","comment":"","msgTable":[[{"key":"rating","value":"50"},{"key":"rating","value":"5"}],[{"value":"172"},{"value":"5"}],[{"value":"133"},{"value":"1"}],[{"value":"242"},{"value":"3"}],[{"value":"302"},{"value":"3"}],[{"value":"377"},{"value":"1"}],[{"value":"51"},{"value":"2"}],[{"value":"346"},{"value":"1"}],[{"value":"474"},{"value":"4"}],[{"value":"265"},{"value":"2"}]],"columnNames":[{"name":"movie_id","index":0,"aggr":"sum"},{"name":"rating","index":1,"aggr":"sum"}],"rows":[["50","5"],["172","5"],["133","1"],["242","3"],["302","3"],["377","1"],["51","2"],["346","1"],["474","4"],["265","2"]]},"dateCreated":"2018-05-07T02:03:21+0000","dateStarted":"2018-05-07T02:04:25+0000","dateFinished":"2018-05-07T02:04:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:419"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1525658625838_1494888791","id":"20180507-020345_2112042605","dateCreated":"2018-05-07T02:03:45+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:420"}],"name":"movie_ratings","id":"2DCCURFYK","angularObjects":{"2BYG9GAN3:shared_process":[],"2C139U1BG:shared_process":[],"2BYWWZJPK:shared_process":[],"2C2VAKPN2:shared_process":[],"2BZC2RPUW:shared_process":[],"2BZQEH9EH:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}